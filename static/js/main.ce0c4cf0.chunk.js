(this["webpackJsonpbooks-kiosk"]=this["webpackJsonpbooks-kiosk"]||[]).push([[0],{26:function(e,t,a){e.exports=a.p+"static/media/NoImage.a06c99c1.png"},32:function(e,t,a){e.exports=a.p+"static/media/logo.987cc879.svg"},40:function(e,t,a){e.exports=a(52)},45:function(e,t,a){},51:function(e,t,a){},52:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"required",(function(){return U})),a.d(n,"date",(function(){return H})),a.d(n,"text",(function(){return z})),a.d(n,"composeValidators",(function(){return q}));var r=a(0),o=a.n(r),l=a(9),c=a.n(l);a(45);var i=function(){return o.a.createElement("nav",{className:"navbar navbar-expand-lg fixed-top navbar-dark bg-dark"},o.a.createElement("a",{className:"navbar-brand mr-auto mr-lg-0",href:"."},"Books Kiosk"))},u=a(32),d=a.n(u);var s=function(e){var t=e.children;return(o.a.createElement("main",{role:"main",className:"container"},o.a.createElement("div",{className:"d-flex align-items-center p-3 my-3 text-white-50 bg-primary rounded shadow-sm"},o.a.createElement("img",{className:"mr-3",src:d.a,alt:"",width:"48",height:"48"}),o.a.createElement("div",{className:"lh-100"},o.a.createElement("h5",{className:"mb-0 text-white lh-100"},"Books"))),t))},m=a(6),f=a(12),v=a(56),E=a(25),b=a.n(E),h=a(33),p={fetch:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=Object(h.a)(b.a.mark((function e(t){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){setTimeout((function(){e()}),500)}));case 2:return e.next=4,fetch("".concat("/books-kiosk").concat(t));case 4:return a=e.sent,e.abrupt("return",a.json());case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};var y=a(22),k={loading:!1,data:null,error:null},g={FETCH:"FETCH",SUCCESS:"SUCCESS",ERROR:"ERROR",EDIT:"EDIT",DELETE:"DELETE"};var C=function(e,t){switch(t.type){case g.FETCH:return Object(m.a)({},e,{loading:!0});case g.SUCCESS:return Object(m.a)({},e,{data:t.payload,loading:!1,error:null});case g.ERROR:return Object(m.a)({},e,{error:t.payload,loading:!1});case g.EDIT:var a=t.payload,n=Object(y.a)(e.data),r=n.findIndex((function(e){var t=e.id;return a.id===t}));return n.splice(r,1,Object(m.a)({},n[r],{},a)),Object(m.a)({},e,{data:n});case g.ADD:var o=t.payload;return Object(m.a)({},e,{data:[].concat(Object(y.a)(e.data),[o])});case g.DELETE:var l=t.payload,c=Object(y.a)(e.data),i=c.findIndex((function(e){var t=e.id;return l.id===t}));return c.splice(i,1),Object(m.a)({},e,{data:c});default:throw new Error("Unsupported action type: ".concat(t.type))}};var j=Object(r.createContext)();var O=function(e){var t=e.children,a=Object(r.useReducer)(C,k),n=Object(f.a)(a,2),l=n[0],c=n[1],i=Object(r.useCallback)((function(){return c({type:g.FETCH}),p.fetch("/books.json").then((function(e){c({type:g.SUCCESS,payload:e})}))}),[c]),u=Object(r.useCallback)((function(e){var t=function(e,t){if(e.filter((function(e){return e.id!==t.id})).map((function(e){return e.title})).includes(t.title))return{title:"Title should be unique."}}(l.data,e);if(t){var a=Error("Not valid");return a.fields=t,Promise.reject(a)}return e.id?c({type:g.EDIT,payload:e}):c({type:g.ADD,payload:Object(m.a)({},e,{id:Object(v.a)()})}),Promise.resolve()}),[l,c]),d=Object(r.useCallback)((function(e){c({type:g.DELETE,payload:e})}),[c]),s=o.a.useMemo((function(){return{state:l,fetchBooks:i,changeBook:u,deleteBook:d}}),[l,i,u,d]);return o.a.createElement(j.Provider,{value:s},t)},w=a(57);var D=function(e){var t=e.children;return(o.a.createElement("div",{className:"d-block text-right mt-3"},t))};function T(e){var t=e.children;return(o.a.createElement("div",{className:"my-3 p-3 bg-white rounded shadow-sm"},t))}T.Footer=D;var S=T,x=a(13),F=function(e){return e.replace(/[^a-zA-Z\s]+/g,"").replace(/\s+/g," ").trim().toLowerCase().split(" ").map((function(e){return e.replace(e.charAt(0),e.charAt(0).toUpperCase())})).join(" ")},I=a(26),N=a.n(I);function L(e){var t=e.book,a=e.onEdit,n=e.onDelete,l=Object(r.useCallback)((function(){a(t)}),[t,a]),c=Object(r.useCallback)((function(){n(t)}),[t,n]),i=Object(r.useCallback)((function(e){e.target.src=N.a}),[]);return o.a.createElement("div",{className:"media text-muted pb-3 mb-3 border-bottom"},o.a.createElement("img",{className:"bd-placeholder-img mr-2 rounded",src:t.image||N.a,alt:t.title,style:{width:"80px"},onError:i}),o.a.createElement("div",{className:"media-body pb-3 mb-0 small lh-125 border-gray"},o.a.createElement("div",{className:"d-flex justify-content-between"},o.a.createElement("div",null,o.a.createElement("h6",{className:"mb-0"},F(t.title)),o.a.createElement("strong",{className:"d-block text-gray-dark"},t.author),o.a.createElement("small",null,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yyyy-LL-dd";return x.DateTime.fromFormat(e,t).toFormat("LL/dd/yyyy")}(t.date))),o.a.createElement("div",{style:{whiteSpace:"nowrap"}},o.a.createElement(w.a,{variant:"link",size:"sm",onClick:l},"Edit"),"|",o.a.createElement(w.a,{variant:"link danger",size:"sm",onClick:c},"Delete")))))}L.defaultProps={onEdit:function(){},onDelete:function(){}};var B=L;function A(e){var t=e.books,a=e.onAdd,n=e.onEdit,r=e.onDelete;return(o.a.createElement(S,null,t.map((function(e){return o.a.createElement(B,{key:e.id,book:e,onEdit:n,onDelete:r})})),!t.length&&o.a.createElement("div",null,"Your kiosk is empty. Please add a book."),o.a.createElement(S.Footer,null,o.a.createElement(w.a,{variant:"link",size:"sm",onClick:a},"Add Book"))))}A.defaultProps={onAdd:function(){},onEdit:function(){},onDelete:function(){}};var R=A,P=a(55),V={REQUIRED:"This field can't be empty.",TEXT:"This field should have correct text.",DATE:"This field is not valid date."};function U(e){return e?void 0:V.REQUIRED}function H(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"yyyy-LL-dd";return function(t){return t&&!x.DateTime.fromFormat(t,e).isValid?V.DATE:void 0}}function z(e){if(!e||e&&!e.match(/[a-zA-Z]+/g))return V.TEXT}var q=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return function(e){for(var a=[],n=0;n<t.length;n+=1){var r=t[n](e);r&&a.push(r)}return a.length?a:void 0}},Y=a(20),_=a(8),M=function(e){return o.a.createElement(_.a.Control,e)},J=a(21),Q=a(35),W=a.n(Q),X=function(e){var t=e.value,a=e.dateFormat,n=e.onChange,r=Object(J.a)(e,["value","dateFormat","onChange"]),l=x.DateTime.fromFormat(t||"","yyyy-LL-dd"),c=t;return l.isValid&&(c=l.toFormat(a)),o.a.createElement(W.a,Object.assign({},r,{mask:"99/99/9999",value:c,onChange:function(e){var t=e.target.value,r=x.DateTime.fromFormat(t,a);r.isValid?n(r.toFormat("yyyy-LL-dd")):n(t)}}),(function(e){return o.a.createElement(_.a.Control,Object.assign({},e,{value:c}))}))};X.defaultProps={value:""};var Z=X,G=function(e){var t=e.active,a=e.visited,n=e.invalid;return(e.submitFailed||a)&&!t&&n},K=function(e){var t=e.name,a=e.label,n=e.helpText,r=e.validate,l=e.control,c=e.controlId,i=e.placeholder,u=e.dateFormat,d={placeholder:i};return u&&Object.assign(d,{dateFormat:u}),o.a.createElement(Y.a,{name:t,validate:r},(function(e){var t=e.input,r=e.meta,i=r.error,u=r.submitError,s=!(r.dirtySinceLastSubmit||!u),m=!(s||!G(r)||!i);return o.a.createElement(_.a.Group,{controlId:c},!!a&&o.a.createElement(_.a.Label,null,a),o.a.createElement(l,Object.assign({isInvalid:m||s},t,d)),!!n&&r.active&&o.a.createElement(_.a.Text,null,n),!!s&&o.a.createElement(_.a.Control.Feedback,{type:"invalid"},u),!!m&&o.a.createElement(_.a.Control.Feedback,{type:"invalid"},function(e){return e?"string"===typeof e||e instanceof String?e:e[0]:""}(i)))}))};K.defaultProps={validate:function(){},control:M,label:void 0,helpText:void 0,placeholder:void 0,dateFormat:void 0};var $=K;function ee(e){var t=e.onSubmit,a=e.validate,n=void 0===a?function(){return{}}:a,r=e.initialValues,l=e.formId,c=e.children;return(o.a.createElement(Y.b,{onSubmit:t,validate:n,initialValues:r,render:function(e){var t=e.handleSubmit,a=e.invalid,n=Object(J.a)(e,["handleSubmit","invalid"]);return(o.a.createElement(_.a,{onSubmit:t,noValidate:!0,id:l},c(Object(m.a)({},n,{invalid:a}))))}}))}ee.defaultProps={validate:function(){},initialValues:void 0,formId:void 0};var te=ee,ae={title:n.composeValidators(n.required,n.text),author:n.composeValidators(n.required,n.text),date:n.composeValidators(n.required,n.date())};function ne(e){var t=e.show,a=e.data,n=e.onClose,l=e.onSubmit,c=Object(r.useCallback)((function(e){return l(Object(m.a)({},a,{},e))}),[a,l]);return o.a.createElement(P.a,{show:t,onHide:n},o.a.createElement(P.a.Header,{closeButton:!0},o.a.createElement(P.a.Title,null,a?"Edit Book":"Add Book")),o.a.createElement(te,{onSubmit:c,initialValues:a},(function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(P.a.Body,null,o.a.createElement($,{name:"title",label:"Title",placeholder:"Enter book name.",validate:ae.title,controlId:"id_title"}),o.a.createElement($,{name:"author",label:"Author",placeholder:"Enter author name.",validate:ae.author,controlId:"id_author"}),o.a.createElement($,{name:"date",label:"Date",placeholder:"MM/DD/YYYY",validate:ae.date,controlId:"id_date",control:Z,dateFormat:"LL/dd/yyyy"}),o.a.createElement($,{name:"image",label:"Image",placeholder:"Image http(s) path.",controlId:"id_image"})),o.a.createElement(P.a.Footer,null,o.a.createElement(w.a,{variant:"secondary",onClick:n},"Close"),o.a.createElement(w.a,{variant:"primary",type:"submit"},"Save Changes")))})))}ne.defaultProps={onClose:function(){},onSubmit:function(){},show:!1,data:void 0};var re=ne,oe=a(38);a(51);var le=function(){return o.a.createElement("div",{className:"loader"},o.a.createElement("div",{className:"loader-backdrop"}),o.a.createElement("div",{className:"loader-spinner"},o.a.createElement(oe.a,{animation:"border",variant:"primary"})))};var ce=function(){return o.a.createElement("div",null,"Error")};function ie(e){var t=e.show,a=e.message,n=e.data,l=e.onClose,c=e.onDelete,i=Object(r.useCallback)((function(){c(n)}),[n,c]);return o.a.createElement(P.a,{size:"xs",show:t,onHide:l},o.a.createElement(P.a.Body,null,a),o.a.createElement(P.a.Footer,null,o.a.createElement(w.a,{variant:"secondary",onClick:l},"Cancel"),o.a.createElement(w.a,{variant:"danger",onClick:i},"Delete")))}ie.defaultProps={onClose:function(){},onDelete:function(){},show:!1,message:"",data:null};var ue=ie;var de=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(r.useState)(e),a=Object(f.a)(t,2),n=a[0],o=a[1],l=Object(r.useCallback)((function(){return o((function(e){return!e}))}),[]);return[n,l]};var se=function(){var e=Object(r.useContext)(j),t=e.state,a=e.fetchBooks,n=e.deleteBook,l=e.changeBook,c=t.data,i=t.loading,u=t.error,d=de(!1),s=Object(f.a)(d,2),m=s[0],v=s[1],E=de(!1),b=Object(f.a)(E,2),h=b[0],p=b[1],y=Object(r.useState)(null),k=Object(f.a)(y,2),g=k[0],C=k[1],O=Object(r.useCallback)((function(){C(null),p()}),[p]),w=Object(r.useCallback)((function(e){C(e),p()}),[p]),D=Object(r.useCallback)((function(e){C(e),v()}),[v]),T=Object(r.useCallback)((function(e){C(null),n(e),v()}),[v,n]),S=Object(r.useCallback)((function(e){return l(e).then((function(){p()})).catch((function(e){return e.fields}))}),[p,l]);return Object(r.useEffect)((function(){a()}),[a]),i||!c?o.a.createElement(le,null):u?o.a.createElement(ce,null):o.a.createElement(o.a.Fragment,null,o.a.createElement(R,{books:c,onAdd:O,onEdit:w,onDelete:D}),o.a.createElement(re,{data:g,show:h,onClose:p,onSubmit:S}),o.a.createElement(ue,{data:g,message:o.a.createElement("span",null,"Do you want to delete\xa0",o.a.createElement("strong",null,'"',g&&F(g.title),'"'),"\xa0book?"),show:m,onClose:v,onDelete:T}))};function me(){return o.a.createElement(O,null,o.a.createElement(se,null))}var fe=function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(i,null),o.a.createElement(s,null,o.a.createElement(me,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(fe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[40,1,2]]]);
//# sourceMappingURL=main.ce0c4cf0.chunk.js.map