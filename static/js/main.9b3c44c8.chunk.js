(this["webpackJsonpbooks-kiosk"]=this["webpackJsonpbooks-kiosk"]||[]).push([[0],{26:function(e,t,a){e.exports=a.p+"static/media/NoImage.a06c99c1.png"},32:function(e,t,a){e.exports=a.p+"static/media/logo.987cc879.svg"},39:function(e,t,a){e.exports=a(50)},44:function(e,t,a){},49:function(e,t,a){},50:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"required",(function(){return U})),a.d(n,"date",(function(){return H})),a.d(n,"composeValidators",(function(){return q}));var r=a(0),o=a.n(r),l=a(10),c=a.n(l);a(44);var i=function(){return o.a.createElement("nav",{className:"navbar navbar-expand-lg fixed-top navbar-dark bg-dark"},o.a.createElement("a",{className:"navbar-brand mr-auto mr-lg-0",href:"."},"Books Kiosk"))},u=a(32),d=a.n(u);var s=function(e){var t=e.children;return(o.a.createElement("main",{role:"main",className:"container"},o.a.createElement("div",{className:"d-flex align-items-center p-3 my-3 text-white-50 bg-primary rounded shadow-sm"},o.a.createElement("img",{className:"mr-3",src:d.a,alt:"",width:"48",height:"48"}),o.a.createElement("div",{className:"lh-100"},o.a.createElement("h5",{className:"mb-0 text-white lh-100"},"Books"))),t))},m=a(6),f=a(12),v=a(54),E=a(22),b={loading:!1,data:null,error:null},p={FETCH:"FETCH",SUCCESS:"SUCCESS",ERROR:"ERROR",EDIT:"EDIT",DELETE:"DELETE"};function h(e,t){switch(t.type){case p.FETCH:return Object(m.a)({},e,{loading:!0});case p.SUCCESS:return Object(m.a)({},e,{data:t.payload,loading:!1,error:null});case p.ERROR:return Object(m.a)({},e,{error:t.payload,loading:!1});case p.EDIT:var a=t.payload,n=Object(E.a)(e.data),r=n.findIndex((function(e){var t=e.id;return a.id===t}));return n.splice(r,1,Object(m.a)({},n[r],{},a)),Object(m.a)({},e,{data:n});case p.ADD:var o=t.payload;return Object(m.a)({},e,{data:[].concat(Object(E.a)(e.data),[o])});case p.DELETE:var l=t.payload,c=Object(E.a)(e.data),i=c.findIndex((function(e){var t=e.id;return l.id===t}));return c.splice(i,1),Object(m.a)({},e,{data:c});default:throw new Error("Unsupported action type: ".concat(t.type))}}var y=a(25),k=a.n(y),g=a(33),C={fetch:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=Object(g.a)(k.a.mark((function e(t){var a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){setTimeout((function(){e()}),500)}));case 2:return e.next=4,fetch("".concat("/books-kiosk").concat(t));case 4:return a=e.sent,e.abrupt("return",a.json());case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};var j=Object(r.createContext)();var O=function(e){var t=e.children,a=Object(r.useReducer)(h,b),n=Object(f.a)(a,2),l=n[0],c=n[1],i=Object(r.useCallback)((function(){return c({type:p.FETCH}),C.fetch("/books.json").then((function(e){c({type:p.SUCCESS,payload:e})}))}),[c]),u=Object(r.useCallback)((function(e){var t=function(e,t){if(e.filter((function(e){return e.id!==t.id})).map((function(e){return e.title})).includes(t.title))return{title:"Title should be unique."}}(l.data,e);if(t){var a=Error("Not valid");return a.fields=t,Promise.reject(a)}return e.id?c({type:p.EDIT,payload:e}):c({type:p.ADD,payload:Object(m.a)({},e,{id:Object(v.a)()})}),Promise.resolve()}),[l,c]),d=Object(r.useCallback)((function(e){c({type:p.DELETE,payload:e})}),[c]),s=o.a.useMemo((function(){return{state:l,fetchBooks:i,changeBook:u,deleteBook:d}}),[l,i,u,d]);return o.a.createElement(j.Provider,{value:s},t)},w=a(55);var D=function(e){var t=e.children;return(o.a.createElement("div",{className:"d-block text-right mt-3"},t))};function S(e){var t=e.children;return(o.a.createElement("div",{className:"my-3 p-3 bg-white rounded shadow-sm"},t))}S.Footer=D;var F=S,T=a(13),x=function(e){return e.replace(/[^a-zA-Z\s]+/g,"").replace(/\s+/g," ").trim().toLowerCase().split(" ").map((function(e){return e.replace(e.charAt(0),e.charAt(0).toUpperCase())})).join(" ")},I=a(26),N=a.n(I);function L(e){var t=e.book,a=e.onEdit,n=e.onDelete,l=Object(r.useCallback)((function(){a(t)}),[t,a]),c=Object(r.useCallback)((function(){n(t)}),[t,n]),i=Object(r.useCallback)((function(e){e.target.src=N.a}),[]);return o.a.createElement("div",{className:"media text-muted pb-3 mb-3 border-bottom"},o.a.createElement("img",{className:"bd-placeholder-img mr-2 rounded",src:t.image||N.a,alt:t.title,style:{width:"80px"},onError:i}),o.a.createElement("div",{className:"media-body pb-3 mb-0 small lh-125 border-gray"},o.a.createElement("div",{className:"d-flex justify-content-between"},o.a.createElement("div",null,o.a.createElement("h6",{className:"mb-0"},x(t.title)),o.a.createElement("strong",{className:"d-block text-gray-dark"},t.author),o.a.createElement("small",null,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yyyy-LL-dd";return T.DateTime.fromFormat(e,t).toFormat("LL/dd/yyyy")}(t.date))),o.a.createElement("div",{style:{whiteSpace:"nowrap"}},o.a.createElement(w.a,{variant:"link",size:"sm",onClick:l},"Edit"),"|",o.a.createElement(w.a,{variant:"link danger",size:"sm",onClick:c},"Delete")))))}L.defaultProps={onEdit:function(){},onDelete:function(){}};var B=L;function A(e){var t=e.books,a=e.onAdd,n=e.onEdit,r=e.onDelete;return(o.a.createElement(F,null,t.map((function(e){return o.a.createElement(B,{key:e.id,book:e,onEdit:n,onDelete:r})})),!t.length&&o.a.createElement("div",null,"Your kiosk is empty. Please add a book."),o.a.createElement(F.Footer,null,o.a.createElement(w.a,{variant:"link",size:"sm",onClick:a},"Add Book"))))}A.defaultProps={onAdd:function(){},onEdit:function(){},onDelete:function(){}};var R=A,P=a(53),V={REQUIRED:"This field can't be empty.",DATE:"This field is not valid date."};function U(e){return e?void 0:V.REQUIRED}function H(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"yyyy-LL-dd";return function(t){return t&&!T.DateTime.fromFormat(t,e).isValid?V.DATE:void 0}}var q=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return function(e){for(var a=[],n=0;n<t.length;n+=1){var r=t[n](e);r&&a.push(r)}return a.length?a:void 0}},z=a(20),Y=a(8),_=function(e){return o.a.createElement(Y.a.Control,e)},M=a(21),J=function(e){var t=e.value,a=e.dateFormat,n=e.onChange,r=Object(M.a)(e,["value","dateFormat","onChange"]),l=T.DateTime.fromFormat(t||"","yyyy-LL-dd"),c=t;return l.isValid&&(c=l.toFormat(a)),o.a.createElement(Y.a.Control,Object.assign({value:c},r,{onChange:function(e){var t=e.target.value,r=T.DateTime.fromFormat(t,a);r.isValid?n(r.toFormat("yyyy-LL-dd")):n(t)}}))};J.defaultProps={value:""};var Q=J,W=function(e){var t=e.active,a=e.visited,n=e.invalid;return(e.submitFailed||a)&&!t&&n},G=function(e){var t=e.name,a=e.label,n=e.helpText,r=e.validate,l=e.control,c=e.controlId,i=e.placeholder,u=e.dateFormat,d={placeholder:i};return u&&Object.assign(d,{dateFormat:u}),o.a.createElement(z.a,{name:t,validate:r},(function(e){var t=e.input,r=e.meta,i=r.error,u=r.submitError,s=!(r.dirtySinceLastSubmit||!u),m=!(s||!W(r)||!i);return o.a.createElement(Y.a.Group,{controlId:c},!!a&&o.a.createElement(Y.a.Label,null,a),o.a.createElement(l,Object.assign({isInvalid:m||s},t,d)),!!n&&r.active&&o.a.createElement(Y.a.Text,null,n),!!s&&o.a.createElement(Y.a.Control.Feedback,{type:"invalid"},u),!!m&&o.a.createElement(Y.a.Control.Feedback,{type:"invalid"},function(e){return e?"string"===typeof e||e instanceof String?e:e[0]:""}(i)))}))};G.defaultProps={validate:function(){},control:_,label:void 0,helpText:void 0,placeholder:void 0,dateFormat:void 0};var K=G;function Z(e){var t=e.onSubmit,a=e.validate,n=void 0===a?function(){return{}}:a,r=e.initialValues,l=e.formId,c=e.children;return(o.a.createElement(z.b,{onSubmit:t,validate:n,initialValues:r,render:function(e){var t=e.handleSubmit,a=e.invalid,n=Object(M.a)(e,["handleSubmit","invalid"]);return(o.a.createElement(Y.a,{onSubmit:t,noValidate:!0,id:l},c(Object(m.a)({},n,{invalid:a}))))}}))}Z.defaultProps={validate:function(){},initialValues:void 0,formId:void 0};var $=Z,X={title:n.required,author:n.required,date:n.composeValidators(n.required,n.date())};function ee(e){var t=e.show,a=e.data,n=e.onClose,l=e.onSubmit,c=Object(r.useCallback)((function(e){return l(Object(m.a)({},a,{},e))}),[a,l]);return o.a.createElement(P.a,{show:t,onHide:n},o.a.createElement(P.a.Header,{closeButton:!0},o.a.createElement(P.a.Title,null,a?"Edit Book":"Add Book")),o.a.createElement($,{onSubmit:c,initialValues:a},(function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(P.a.Body,null,o.a.createElement(K,{name:"title",label:"Title",placeholder:"Enter book name.",validate:X.title,controlId:"id_title"}),o.a.createElement(K,{name:"author",label:"Author",placeholder:"Enter author name.",validate:X.author,controlId:"id_author"}),o.a.createElement(K,{name:"date",label:"Date",placeholder:"MM/DD/YYYY",validate:X.date,controlId:"id_date",control:Q,dateFormat:"LL/dd/yyyy"}),o.a.createElement(K,{name:"image",label:"Image",placeholder:"Image http(s) path.",controlId:"id_image"})),o.a.createElement(P.a.Footer,null,o.a.createElement(w.a,{variant:"secondary",onClick:n},"Close"),o.a.createElement(w.a,{variant:"primary",type:"submit"},"Save Changes")))})))}ee.defaultProps={onClose:function(){},onSubmit:function(){},show:!1,data:void 0};var te=ee,ae=a(37);a(49);var ne=function(){return o.a.createElement("div",{className:"loader"},o.a.createElement("div",{className:"loader-backdrop"}),o.a.createElement("div",{className:"loader-spinner"},o.a.createElement(ae.a,{animation:"border",variant:"primary"})))};var re=function(){return o.a.createElement("div",null,"Error")};function oe(e){var t=e.show,a=e.message,n=e.data,l=e.onClose,c=e.onDelete,i=Object(r.useCallback)((function(){c(n)}),[n,c]);return o.a.createElement(P.a,{size:"xs",show:t,onHide:l},o.a.createElement(P.a.Body,null,a),o.a.createElement(P.a.Footer,null,o.a.createElement(w.a,{variant:"secondary",onClick:l},"Cancel"),o.a.createElement(w.a,{variant:"danger",onClick:i},"Delete")))}oe.defaultProps={onClose:function(){},onDelete:function(){},show:!1,message:"",data:null};var le=oe;var ce=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(r.useState)(e),a=Object(f.a)(t,2),n=a[0],o=a[1],l=Object(r.useCallback)((function(){return o((function(e){return!e}))}),[]);return[n,l]};var ie=function(){var e=Object(r.useContext)(j),t=e.state,a=e.fetchBooks,n=e.deleteBook,l=e.changeBook,c=t.data,i=t.loading,u=t.error,d=ce(!1),s=Object(f.a)(d,2),m=s[0],v=s[1],E=ce(!1),b=Object(f.a)(E,2),p=b[0],h=b[1],y=Object(r.useState)(null),k=Object(f.a)(y,2),g=k[0],C=k[1],O=Object(r.useCallback)((function(){C(null),h()}),[h]),w=Object(r.useCallback)((function(e){C(e),h()}),[h]),D=Object(r.useCallback)((function(e){C(e),v()}),[v]),S=Object(r.useCallback)((function(e){C(null),n(e),v()}),[v,n]),F=Object(r.useCallback)((function(e){return l(e).then((function(){h()})).catch((function(e){return e.fields}))}),[h,l]);return Object(r.useEffect)((function(){a()}),[a]),i||!c?o.a.createElement(ne,null):u?o.a.createElement(re,null):o.a.createElement(o.a.Fragment,null,o.a.createElement(R,{books:c,onAdd:O,onEdit:w,onDelete:D}),o.a.createElement(te,{data:g,show:p,onClose:h,onSubmit:F}),o.a.createElement(le,{data:g,message:o.a.createElement("span",null,"Do you want to delete\xa0",o.a.createElement("strong",null,'"',g&&x(g.title),'"'),"\xa0book?"),show:m,onClose:v,onDelete:S}))};function ue(){return o.a.createElement(O,null,o.a.createElement(ie,null))}var de=function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(i,null),o.a.createElement(s,null,o.a.createElement(ue,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(de,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[39,1,2]]]);
//# sourceMappingURL=main.9b3c44c8.chunk.js.map